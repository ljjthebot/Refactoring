### 用状态/策略替换类型码
#### 问题
你有一个编码类型，它影响行为，但无法使用子类来消除它。

#### 解决方案
用状态对象替换类型码。如果需要用类型码替换字段值，就“插入”另一个状态对象。

#### 用状态/策略替换类型码 - 之前
#### 用状态/策略替换类型码 - 之后

#### 为何重构
你有一个类型码，它影响类的行为，因此无法使用“用类替换类型码”。

类型码影响类的行为，但由于现有的类层次结构或其他原因，无法为编码类型创建子类。因此，无法应用“用子类替换类型码”。

#### 好处
这种重构技术是在对象的生命周期内字段具有编码类型并更改其值的情况下的一种解决方案。在这种情况下，通过替换原始类引用的状态对象来替换值。

如果需要为编码类型添加新值，只需添加一个新的状态子类，而无需更改现有代码（参考开闭原则）。

#### 缺点
如果你只有一个简单的类型码情况，但仍然使用这种重构技术，将会产生许多额外（不需要的）类。

#### 注意
此重构技术的实现可以使用两种设计模式之一：State或Strategy。无论选择哪种模式，实现都是相同的。那么在特定情况下应该选择哪种模式呢？

- 如果尝试拆分控制算法选择的条件，则使用Strategy。
- 但是，如果编码类型的每个值不仅负责选择算法，还负责类的整体条件、类状态、字段值以及许多其他操作，则State更适合此任务。

#### 如何重构
1. 使用“自封装字段”创建包含类型码的字段的getter。
2. 创建一个新类，为其取一个符合类型码目的的可理解的名称。此类将扮演状态（或策略）的角色。在其中，创建一个抽象的编码字段getter。
3. 为编码类型的每个值创建状态类的子类。在每个子类中，重新定义编码字段的getter，使其返回编码类型的相应值。
4. 在抽象状态类中，创建一个静态工厂方法，该方法接受编码类型的值作为参数。根据此参数，工厂方法将创建各种状态的对象。为此，在其代码中创建一个大的条件语句；在重构完成时，它将是唯一的条件语句。
5. 在原始类中，将编码字段的类型更改为状态类。在字段的setter中，调用工厂状态方法以获取新的状态对象。
6. 现在，可以开始将字段和方法从超类移动到相应的状态子类中（使用“字段下移”和“方法下移”）。
7. 移动了所有可移动的内容后，使用“用多态替换条件语句”以彻底摆脱使用类型码的条件。