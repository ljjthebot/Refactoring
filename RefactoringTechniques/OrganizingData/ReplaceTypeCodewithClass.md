### 用类替换类型码
#### 问题
一个类包含一个包含类型码的字段。这种类型的值并不用于操作条件，也不影响程序的行为。

#### 解决方案
创建一个新的类，使用其对象来替代类型码的值。

#### 用类替换类型码 - 之前
#### 用类替换类型码 - 之后

#### 为何重构
类型码最常见的原因之一是与数据库一起工作，当数据库具有某些复杂概念用数字或字符串编码的字段时。

例如，你有一个包含用户访问权限信息的字段`user_role`的`User`类，表示管理员、编辑器或普通用户。在这种情况下，这些信息被编码为A、E和U。

这种方法的缺点是什么？字段的setter通常不检查发送的值，当有人向这些字段发送意外或错误的值时，可能会导致严重问题。

此外，对这些字段进行类型验证是不可能的。可以向它们发送任何数字或字符串，这不会被IDE类型检查，并且甚至允许程序运行（然后崩溃）。

#### 好处
我们希望将编码类型的原始值集转换为具有面向对象编程的所有优势的完整类。

通过用类替换类型码，我们允许在编程语言的级别对传递给方法和字段的值进行类型提示。

例如，当以前编译器在将值传递给方法时无法区分您的数值常量和某个任意数字时，现在当传递不适合指定类型类的数据时，您会在IDE中收到错误警告。

因此，我们可以将代码移到类型的类中。如果您需要在整个程序中对类型值执行复杂操作，现在这些代码可以在一个或多个类型类中“生活”。

#### 不适用情况
如果编码类型的值在控制流结构（if、switch等）内部使用并控制类的行为，应使用两种类型码的重构技术之一：

- 用子类替换类型码
- 用状态/策略替换类型码

#### 如何重构
1. 创建一个新的类，为其赋予与编码类型目的相符的新名称。我们将其称为类型类。
2. 将包含类型码的字段复制到类型类中，并将其设置为私有。然后为该字段创建一个getter。此字段只能从构造函数中设置。
3. 对于编码类型的每个值，在类型类中创建一个静态方法。该方法将创建一个与编码类型的此值相对应的新类型类对象。
4. 在原始类中，将编码字段的类型替换为类型类。在构造函数中以及字段setter中创建此类型的新对象。更改字段的getter，使其调用类型类的getter。
5. 用相关类型类的静态方法调用替换编码类型值的任何提及。
6. 从原始类中移除编码类型常量。