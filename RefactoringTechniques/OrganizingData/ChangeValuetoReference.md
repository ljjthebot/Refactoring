# 将值改为引用

## 问题

有许多相同的单个类实例，您需要用一个单一的对象替换它们。

## 解决方案

将相同的对象转换为一个单一的引用对象。



## 为何要进行重构

在许多系统中，对象可以被分类为值或引用。

引用：当一个真实世界的对象只对应程序中的一个对象时。引用通常是用户/订单/产品等对象。

值：一个真实世界的对象对应程序中的多个对象。这些对象可以是日期、电话号码、地址、颜色等。

选择是引用还是值并不总是明确的。有时存在一个具有少量不变数据的简单值。然后，有必要添加可变数据并在访问对象时传递这些更改。在这种情况下，有必要将其转换为引用。

## 优势

一个对象包含有关特定实体的所有最新信息。如果在程序的一个部分更改了对象，那么使用对象的其他部分也可以访问这些更改。

## 缺点

引用的实现要困难得多。

## 如何进行重构

1. 在需要生成引用的类上使用“用工厂方法替换构造函数”。

2. 确定哪个对象将负责提供对引用的访问。现在，您需要从存储对象或静态字典字段中获取引用对象，而不是创建一个新对象。

3. 确定是预先创建引用还是根据需要动态创建。如果对象是预先创建的，请确保在使用之前加载它们。

4. 更改工厂方法以返回引用。如果对象是预先创建的，决定在请求不存在的对象时如何处理错误。您还可能需要使用“重命名方法”来说明该方法仅返回现有对象。